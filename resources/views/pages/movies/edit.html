{% extends 'layout/base.html' %}{% block container %}

<section class="section pb-42 md:pb-16">
	<div class="wrapper">
		<div class="">
			<div class="mb-8 bg-deep p-4 rounded-sm text-center md:text-left">
				<h1
					class="normal-case font-normal border-l-4 border-solid border-egg w-fit pl-4 text-3xl md:text-4xl leading-8"
				>
					Editar Filme
				</h1>
			</div>

			<form
				action=""
				method="post"
				class="grid sm:grid-cols-3 gap-6"
			>
				{{ csrf_token_input()|raw }}

				<div
					x-data="imagePreview"
					class="flex flex-col gap-6"
				>
					<div class="max-h-[608px]">
						<img
							:src="previewUrl || '{{ movie_image(movie.image) }}'"
							alt="Movie Cape"
							class="p-2 rounded-sm bg-deep h-full w-full object-top object-cover"
						/>
					</div>

					<div>
						<div class="form-field">
							<input
								type="file"
								name="image"
								id="image"
								class="form-field-input text-sm pt-6"
								placeholder=""
								@change="updatePreview($event)"
							/>
							<label
								for="image"
								class="form-field-label"
								>Imagem de capa:</label
							>
						</div>
						{% include "partials/form-input-error.html" with { name: 'image' }
						%}
					</div>
				</div>

				<div class="md:col-span-2">
					<div>
						<div class="form-field">
							{% set input_value = persistent_input('title') %}
							<input
								type="text"
								name="title"
								id="title"
								class="form-field-input"
								placeholder=""
								value="{{ input_value is null ? movie.title : input_value }}"
							/>
							<label
								for="title"
								class="form-field-label"
								>Título:</label
							>
						</div>
						{% include "partials/form-input-error.html" with { name: 'title' }
						%}
					</div>

					<div>
						<div class="form-field">
							{% set input_value = persistent_input('duration') %}
							<input
								type="text"
								name="duration"
								id="duration"
								class="form-field-input"
								placeholder=""
								value="{{ input_value is null ? movie.duration : input_value }}"
							/>
							<label
								for="duration"
								class="form-field-label"
								>Duração (min):</label
							>
						</div>
						{% include "partials/form-input-error.html" with { name: 'duration'
						} %}
					</div>

					<div>
						<div class="form-field">
							{% set input_value = persistent_input('trailerUrl') %}
							<input
								type="text"
								name="trailerUrl"
								id="trailerUrl"
								class="form-field-input"
								placeholder=""
								value="{{ input_value is null ? movie.trailerUrl : input_value }}"
							/>
							<label
								for="trailerUrl"
								class="form-field-label"
								>URL do trailer:</label
							>
						</div>
						{% include "partials/form-input-error.html" with { name:
						'trailerUrl' } %}
					</div>

					<div>
						<div class="form-field">
							{% set input_value = persistent_input('categoryId') %}
							<select
								name="categoryId"
								id="categoryId"
								class="form-field-select"
							>
								<option value="">Selecione a categoria do filme</option>
								{% for category in categories %}
								<option
									value="{{ category.id }}"
									class="bg-dark"
									{{ input_value is null ? category.id.equals(movie.categoryId) ? 'selected' : '' : input_value == category.id ? 'selected' : '' }}
								>
									{{ category.name }}
								</option>
								{% endfor %}
							</select>
							<label
								for="categoryId"
								class="form-field-label"
								>Categoria:</label
							>
						</div>
						{% include "partials/form-input-error.html" with { name:
						'categoryId' } %}
					</div>

					<div class="w-full">
						<div class="form-field h-64">
							{% set input_value = persistent_input('description') %}
							<textarea
								name="description"
								id="description"
								class="form-field-textarea h-full"
								placeholder=""
							>
{{ input_value is null ? movie.description : input_value }}</textarea
							>
							<label
								for="description"
								class="form-field-label"
								>Descrição:</label
							>
						</div>
						{% include "partials/form-input-error.html" with { name:
						'description' } %}
					</div>

					<div class="text-right my-2 col-span-2">
						<button
							type="submit"
							class="secondary-btn py-2 px-6"
						>
							Postar
						</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</section>

{% endblock %}
